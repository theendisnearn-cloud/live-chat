<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Support Dashboard</title>
<style>
  body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 0; }
  #chat-container { width: 500px; margin: 40px auto; background: #fff; border-radius: 8px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); display: flex; flex-direction: column; height: 600px; }
  #messages { flex: 1; padding: 10px; overflow-y: auto; font-size: 14px; }
  .message { margin-bottom: 10px; }
  .message strong { color: #0b0e11; }
  .message span { color: #888; font-size: 12px; margin-left: 4px; }
  #input-container { display: flex; border-top: 1px solid #ddd; }
  #input { flex: 1; padding: 10px; border: none; outline: none; font-size: 14px; }
  #send { padding: 10px 14px; border: none; background: #f0b90b; cursor: pointer; font-weight: bold; }
</style>
</head>
<body>

<div id="chat-container">
  <div id="messages"></div>
  <div id="input-container">
    <input id="input" placeholder="Type message…" />
    <button id="send">Send</button>
  </div>
</div>

<script>
  const messages = document.getElementById("messages");
  const input = document.getElementById("input");
  const sendBtn = document.getElementById("send");

  const ws = new WebSocket("wss://live-chat-4i3s.onrender.com");

  ws.onopen = () => {
    console.log("✅ Support connected to WebSocket");
    ws.send(JSON.stringify({ sender: "support", text: "Support connected", timestamp: new Date().toISOString() }));
  };

  ws.onmessage = (event) => {
    const data = JSON.parse(event.data);

    const div = document.createElement("div");
    div.className = "message";

    const time = new Date(data.timestamp).toLocaleTimeString();

    div.innerHTML = `<strong>${data.sender}</strong> <span>(${time})</span>: ${data.text}`;
    messages.appendChild(div);

    messages.scrollTop = messages.scrollHeight;
  };

  sendBtn.onclick = () => {
    if (!input.value) return;

    const msg = {
      sender: "support",
      text: input.value,
      timestamp: new Date().toISOString()
    };

    ws.send(JSON.stringify(msg));
    input.value = "";
  };

  input.addEventListener("keydown", (e) => {
    if (e.key === "Enter") sendBtn.click();
  });
</script>

</body>
</html>
